<!--
  Blorbioteca is a free and open source character and world repository.
  Copyright (C) 2025 Hannah Kirkland

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->

<!-- templates/base.html -->
{% load static %}
<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Blorbioteca{% endblock %}</title>
  
  <!-- set theme immediately to prevent flash -->
  <script>
    (function() {
      const theme = localStorage.getItem('theme') || 'theme-dark';
      document.documentElement.className = theme;
      
      // Set inline styles immediately
      const html = document.documentElement;
      if (theme === 'theme-light') {
        html.style.backgroundColor = '#f2ecbc';
      } else {
        html.style.backgroundColor = '#181616';
      }
    })();
  </script>
  
  <link rel='stylesheet' type='text/css' href="{% static 'css/base.css' %}">
  {% block extra_css %}{% endblock %}
  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'favicon_io/apple-touch-icon.png' %}">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'favicon_io/favicon-32x32.png' %}">
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'favicon_io/favicon-16x16.png' %}">
  <link rel="manifest" href="{% static 'favicon_io/site.webmanifest' %}">
</head>

<body>
  <header>
    <div class='menu'>
      <form action={% url 'home' %}>
          <button type='submit'>Home</button>
      </form>
      {% if user.is_authenticated %}
      <form action={% url 'login-redirect' %}>
          <button type='submit'>Profile</button>
      </form>
      <form action="{% url 'logout' %}" method="post">
        {% csrf_token %}
        <button type="submit">Log Out</button>
      </form>
      {% else %}
      <a href={% url 'two_factor:login' %}>Log In</a>
      {% endif %}
      <button id="theme-switcher" onclick="toggleTheme()">Switch Theme</button>
    </div>
  </header>
  <main>
    {% block content %}
    {% endblock %}
  </main>
  <footer>
  <p>Licensed under the <a href='https://www.gnu.org/licenses/gpl-3.0.en.html'>GPLv3</a></p>
</footer>
<script src="{% static 'js/theme-switcher.js' %}"></script>
{% block extra_js %}{% endblock %}
</body>

</html>
